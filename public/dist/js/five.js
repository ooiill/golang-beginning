/*!  */
/*! beginning - 1.0.0 - 2021-05-06 */
"use strict";bsw.configure({data:{ws:null,nickname:null,token:null,userId:null,online:0,roomNumber:0,blackPlayer:{},whitePlayer:{},willDown:0},method:{inputNickname:function(){var a=prompt("请输入你的昵称");return null==a||0===a.length?this.inputNickname():a},drop:function(a){a.mousedown(function(b){var c=$(this).offset(),d=b.pageX-c.left,e=b.pageY-c.top;$(document).mousemove(function(b){var c=b.pageX-d,f=b.pageY-e;c<0?c=0:c>$(document).width()-$("div").outerWidth(!0)&&(c=$(document).width()-$("div").outerWidth(!0)),f<0?f=0:f>$(document).height()-$("div").outerHeight(!0)&&(f=$(document).height()-$("div").outerHeight(!0)),a.css({left:c+"px",top:f+"px"})}),$(document).mouseup(function(){$(document).off("mousemove")})})}},logic:{ws:function ws(v){v.nickname=v.inputNickname(),v.ws=new ReconnectingWebSocket("ws://"+window.location.host+"/ws/five"),v.ws.onopen=function(){console.log("成功连接服务器。"),v.ws.send(JSON.stringify({Behavior:"register",Arguments:{nickname:v.nickname}}))},v.ws.onclose=function(){console.log("收到关闭请求，成功断开连接。")},v.ws.onmessage=function(msg){var response=eval("("+msg.data+")");if(console.log("收到消息",response),"register"===response.Behavior){var _ref=[response.Arguments.token,response.Arguments.user_id];v.token=_ref[0],v.userId=_ref[1]}else if("online"===response.Behavior){bsw.success(response.Arguments.message);var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _iterator=response.Arguments.players[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var member=_step.value;"black"===member.chess_color?v.blackPlayer=member:v.whitePlayer=member}}catch(a){_didIteratorError=!0,_iteratorError=a}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}}else"offline"===response.Behavior&&bsw.warning(response.Arguments.message);"undefined"!=typeof response.Arguments.room_number&&(v.roomNumber=response.Arguments.room_number),"undefined"!=typeof response.Arguments.online&&(v.online=response.Arguments.online)},$(".chess").hover(function(){var a=$(this).hasClass("black");$(".container").append('<div class="chess abs '+(a?"black":"white")+'"></div>');var b=bsw.offset($(this));$("div.abs").css({left:b.left,top:b.top})},function(){$(".container div.abs").remove()})}}});